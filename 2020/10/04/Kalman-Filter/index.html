<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/st-32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/st-16x16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Kalman Filter,">










<meta name="description" content="MARSS package1. observation equation:  \mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_{t} + \mathbf{a}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{H}_t \mathbf{v}_t\text{, where } \mathbf{v}_t \sim \text{MVN} (0">
<meta name="keywords" content="Kalman Filter">
<meta property="og:type" content="article">
<meta property="og:title" content="Kalman Filter Summary">
<meta property="og:url" content="http://michaelxiu.com/2020/10/04/Kalman-Filter/index.html">
<meta property="og:site_name" content="Shengjie Xiu">
<meta property="og:description" content="MARSS package1. observation equation:  \mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_{t} + \mathbf{a}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{H}_t \mathbf{v}_t\text{, where } \mathbf{v}_t \sim \text{MVN} (0">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://michaelxiu.com/2020/10/04/assets/ex1_stateUpdate.png">
<meta property="og:image" content="http://michaelxiu.com/2020/10/04/assets/ex1_estimationAlgorithm.png">
<meta property="og:image" content="http://michaelxiu.com/2020/10/04/assets/KalmanFilterAlgorithm.png">
<meta property="og:image" content="http://michaelxiu.com/2020/10/04/assets/DetailedKalmanFilterAlgorithm.png">
<meta property="og:image" content="http://michaelxiu.com/2020/10/04/assets/ex7_EstimateVsTrueVsMeasured.png">
<meta property="og:updated_time" content="2023-03-05T11:21:07.794Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kalman Filter Summary">
<meta name="twitter:description" content="MARSS package1. observation equation:  \mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_{t} + \mathbf{a}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{H}_t \mathbf{v}_t\text{, where } \mathbf{v}_t \sim \text{MVN} (0">
<meta name="twitter:image" content="http://michaelxiu.com/2020/10/04/assets/ex1_stateUpdate.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://michaelxiu.com/2020/10/04/Kalman-Filter/">





  <title>Kalman Filter Summary | Shengjie Xiu</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
	
	<a href="https://github.com/Michael-Xiu" class="github-corner" aria-label="My GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#CABCBC; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shengjie Xiu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">修圣杰</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="https://www.linkedin.com/in/shengjiexiu/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michaelxiu.com/2020/10/04/Kalman-Filter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Shengjie.Xiu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shengjie Xiu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Kalman Filter Summary</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-10-04T16:56:00+08:00">
                2020-10-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              

              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  105 mins
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <a id="more"></a>
<h1 id="MARSS-package"><a href="#MARSS-package" class="headerlink" title="MARSS package"></a>MARSS package</h1><p><em>1. observation equation:</em></p>
<script type="math/tex; mode=display">
\mathbf{y}_t = \mathbf{Z}_t \mathbf{x}_{t} + \mathbf{a}_t + \mathbf{D}_t \mathbf{d}_t + \mathbf{H}_t \mathbf{v}_t\text{, where } \mathbf{v}_t \sim \text{MVN} (0, \mathbf{R}_t)</script><p>includes $n$ measurements, $q$ dimensional inputs, and $n \times h$ dimensional input noise transformation matrix, where, </p>
<ul>
<li>$\mathbf{y}$ is a $n \times T$ matrix of the observations. Some observations may be missing.</li>
<li>$\mathbf{Z}_t$ is a $n \times m$ matrix of parameters.</li>
<li>$\mathbf{a}_t$ is a $n \times 1$ column vector of parameters.</li>
<li>$\mathbf{D}_t$ is a $ n\times q$ matrix of parameters.</li>
<li>$\mathbf{d}_t $ is an input and a $p \times 1$ column vector.</li>
<li>$\mathbf{H}_t$ is an input and a $n \times h$ matrix.</li>
<li>$\mathbf{v}_t$ is a $n \times 1$ column vector of the non-process errors. The observation errors at time $t$ are multivariate normal with mean $0$ and covariance matrix $\mathbf{R}_t$.</li>
</ul>
<p><em>2. state equation:</em></p>
<script type="math/tex; mode=display">
\mathbf{x}_t = \mathbf{B}_t \mathbf{x}_{t-1} + \mathbf{u}_t + \mathbf{C}_t \mathbf{c}_t + \mathbf{G}_t \mathbf{w}_t\text{, where } \mathbf{w}_t \sim \text{MVN} (0, \mathbf{Q}_t)</script><p>includes $m$ states, $p$ dimensional inputs, and $m \times g$ dimensional input noise transformation matrix, where, </p>
<ul>
<li>$\mathbf{x}$ is a $m \times T$ matrix of states. Each $\mathbf{x}_t$ is a realization of the random variable $\mathbf{X}_t$ at time $t$.</li>
<li>$\mathbf{B}_t$ is a $m \times m$ matrix of parameters.</li>
<li>$\mathbf{u}_t$ is a $m \times 1$ column vector of parameters.</li>
<li>$\mathbf{C}_t$ is a $m \times p$ matrix of parameters.</li>
<li>$\mathbf{c}_t$ is an input and a $p \times 1$ column vector.</li>
<li>$\mathbf{G}_t$ is an input and a $m \times g$ matrix.</li>
<li>$\mathbf{w}_t$ is a $m \times 1$ column vector of the process errors. The process errors at time $t$ are multivariate normal with mean $0$ and covariance matrix $\mathbf{Q}_t$.</li>
</ul>
<p><em>3. initial values</em></p>
<script type="math/tex; mode=display">
\mathbf{x}_1 \sim \text{MVN}(\pi, \Lambda)\ \  \text{or} \ \  \mathbf{x}_0 \sim \text{MVN}(\pi, \Lambda)</script><ul>
<li>$\pi$ is either a parameter or a fixed prior. It is a $m\times 1$ matrix.</li>
<li>$\Lambda$ is either a parameter or a fixed prior. It is a $m\times m$ variance-covariance matrix.</li>
</ul>
<p>$\mathbf{Z}_t, \mathbf{a}_t, \mathbf{D}_t, \mathbf{H}_t, \mathbf{R}_t$ in measurement equation and $\mathbf{B}_t, \mathbf{u}_t, \mathbf{C}_t, \mathbf{G}_t,  \mathbf{Q}_t$ in state equation are system matrices that are often assumed to be not random. Although they may be time-variant, their values can be predicted.</p>
<p>System matrices (except $ \mathbf{a}_t$ and $\mathbf{u}_t$) are called hyperparameters if they depend on an unknown parameter and the objective of state space models is estimating these hyperparameters. These hyperparameters will influence the statistical features of the model.</p>
<p>Usually $\mathbf{a}_t$ and $\mathbf{u}_t$ only affect the expectations of $x_t$ and $y_t$. If they are the linear functions of unknown variables or the lag of $y_t$, they can become parts of state variables or hyperparameters.</p>
<p>When a model is written in a state space form, it can be solved by some algorithms and the Kalman filter is the core of these algorithms. Kalman filters make use of the information at time $t$ to make the most convincing predictions. They assume that noises and initial states are normally distributed, and calculate likelihood functions based on decomposition of error. Besides, they update the states when there is new observation.</p>
<h1 id="Durbin’s-book"><a href="#Durbin’s-book" class="headerlink" title="Durbin’s book"></a>Durbin’s book</h1><h2 id="linear-Gaussian-state-space-model"><a href="#linear-Gaussian-state-space-model" class="headerlink" title="linear Gaussian state space model"></a>linear Gaussian state space model</h2><script type="math/tex; mode=display">
\begin{align*}
\tag{1}
    y_t &= Z_t \alpha_t + \varepsilon_t, \ \ \ \ &\varepsilon_t \sim \text{N}(0, H_t) \\
    \alpha_{t+1} &= T_t \alpha_t + R_t \eta_t, \ \ \ \  &\eta_t \sim \text{N}(0, Q_t) \\
\end{align*}</script><ul>
<li>$y_t$ is  a $p\times 1$ observation vector.</li>
<li><p>$a_t$ is an unobserved $m\times 1$ state vector.</p>
</li>
<li><p>$Z_t$, $T_t$, $R_t$, $H_t$ and $Q_t$ are initially assumed to be known. $Z_t$ and $T_{t-1}$ can depend on $y_1, \dots, y_{t-1}$.</p>
</li>
<li>Error terms $\varepsilon_t$ and $\eta_t$ are assumed to be serially and mutually independent.</li>
<li>Initial state vector $\alpha_1$ is assumed to be $\text{N}(a_1, P_1)$ independently of $\varepsilon_1, \dots, \varepsilon_n$ and $\eta_1, \dots, \eta_n$.</li>
</ul>
<p>The <em>general linear state space model</em> is the same as $(1)$ except that the normality assumption is dropped.</p>
<p>Define $Y_T$ as the information set that can be used at $t=T$, i.e. $Y_T = (y_1^{‘},y_2^{‘}, \dots, y_T^{‘})^{‘}$. The estimation of states can be divided into three cases depending on how much information we have:</p>
<ol>
<li>If $t&gt;T$, it is an estimation of future states and called <em>prediction</em>;</li>
<li>If $t=T$, it is an estimation of current states and called <em>filtering</em>;</li>
<li>If $t&lt;T$, it is an estimation of previous states and called <em>smoothing</em>.</li>
</ol>
<p>Durbin notation notice: </p>
<ol>
<li>$a_t, P_t$ without the $Y_t$ conditions are prior estimation; $v_t$ is also a prior estimation.</li>
</ol>
<h1 id="Wikipedia"><a href="#Wikipedia" class="headerlink" title="Wikipedia"></a>Wikipedia</h1><p><strong>Predict</strong></p>
<ul>
<li>Predicted (<em>a priori</em>) state estimate</li>
</ul>
<script type="math/tex; mode=display">
\hat{\alpha}_{t|t-1}=T_t \hat{\alpha}_{t-1|t-1} \\
(a_{t|t-1} = T_t a_{t-1|t-1})</script><ul>
<li>Predicted (<em>a priori</em>) estimate covariance</li>
</ul>
<script type="math/tex; mode=display">
P_{t|t-1} = T_t P_{t-1|t-1} T_t^\intercal + Q_k</script><p><strong>I. Predicted state = <em>state equation</em> (last updated state)</strong></p>
<p><strong>Update</strong></p>
<ul>
<li>Innovation or measurement pre-fit residual</li>
</ul>
<script type="math/tex; mode=display">
v_{t|t-1} = y_t - Z_t \hat{\alpha}_{t|t-1}</script><ul>
<li>Innovation (or pre-fit residual) covariance</li>
</ul>
<script type="math/tex; mode=display">
F_t = Var(v_{t|t-1}) = Z_t P_{t|t-1} Z_t^\intercal + H_t</script><p><strong>II. Pre-fit residual = measurement - <em>observation equation</em> (predicted state)</strong></p>
<ul>
<li><em>Optimal</em> Kalman gain</li>
</ul>
<script type="math/tex; mode=display">
K_t = P_{t|t-1}  Z_t^\intercal F_t^{-1}</script><ul>
<li>Updated (<em>a posteriori</em>) state estimate</li>
</ul>
<script type="math/tex; mode=display">
\hat{\alpha}_{t|t} = \hat{\alpha}_{t|t-1} + K_t v_{t|t-1}</script><ul>
<li>Updated (<em>a posteriori</em>) estimate covariance</li>
</ul>
<script type="math/tex; mode=display">
P_{t|t} = (I-K_t Z_t) P_{t|t-1}</script><ul>
<li>Measurement post-fit residual</li>
</ul>
<script type="math/tex; mode=display">
v_{t|t} = y_t - Z_t \hat{\alpha}_{t|t}</script><h1 id="Tutorial-by-Alex-Becker"><a href="#Tutorial-by-Alex-Becker" class="headerlink" title="Tutorial by Alex Becker"></a>Tutorial by Alex Becker</h1><h2 id="The-alpha-beta-gamma-Filter"><a href="#The-alpha-beta-gamma-Filter" class="headerlink" title="The $\alpha-\beta-\gamma$ Filter"></a>The $\alpha-\beta-\gamma$ Filter</h2><h3 id="EXAMPLE-1-WEIGHTING-THE-GOLD"><a href="#EXAMPLE-1-WEIGHTING-THE-GOLD" class="headerlink" title="EXAMPLE 1 WEIGHTING THE GOLD"></a>EXAMPLE 1 WEIGHTING THE GOLD</h3><p>The overall logic of state update equation:</p>
<p><img src="../assets/ex1_stateUpdate.png" style="zoom:65%;"></p>
<script type="math/tex; mode=display">
\hat{x}_{n,n}= \hat{x}_{n,n-1}+  \alpha _{n} \left( z_{n}-\hat{x}_{n,n-1} \right)</script><p>The term $\left( z_{n}- x_{n,n-1} \right)$ is a measurement residual, also called the <strong>innovation</strong>. The innovation contains the newest information.</p>
<p>Before we make the first measurement, we can guess (or rough estimate) the gold bar weight simply by reading the stamp on the gold bar. It is called the <strong>Initial Guess</strong> and it will be our first estimate.</p>
<p>As we will see later, the Kalman Filter requires the initial guess as a preset, and it can be very rough.</p>
<p>The estimation algorithm:</p>
<p><img src="../assets/ex1_estimationAlgorithm.png" style="zoom:80%;"></p>
<h3 id="EXAMPLE-2-TRACKING-THE-CONSTANT-VELOCITY-AIRCRAFT-IN-ONE-DIMENSION"><a href="#EXAMPLE-2-TRACKING-THE-CONSTANT-VELOCITY-AIRCRAFT-IN-ONE-DIMENSION" class="headerlink" title="EXAMPLE 2 TRACKING THE CONSTANT VELOCITY AIRCRAFT IN ONE DIMENSION"></a>EXAMPLE 2 TRACKING THE CONSTANT VELOCITY AIRCRAFT IN ONE DIMENSION</h3><p><strong>Equation1: State Extrapolation Equation</strong> (also called a <strong>Transition Equation</strong>, a <strong>Prediction Equation</strong>, a <strong>Dynamic Model</strong>, or a <strong>State Space Model</strong>) : the state equation in the standard form of Kalman Filters to predict the states.</p>
<p><strong>Equation2: State Update Equation</strong> (also called a <strong>Filtering Equation</strong>): Equation including Kalman Gain that used to update the prediction into final estimate based on the new observation.</p>
<h2 id="Kalman-Filter-in-one-dimension"><a href="#Kalman-Filter-in-one-dimension" class="headerlink" title="Kalman Filter in one dimension"></a>Kalman Filter in one dimension</h2><p>The differences between the measurements (blue samples) and the true value (green line) are measurement errors. Since the measurement errors are random, we can describe them by variance ( $\sigma^2$ ). The variance of the measurement errors could be provided by the scale vendor or can be derived by calibration procedure. The variance of the measurement errors is actually the <strong>measurement uncertainty</strong>.</p>
<p>Note: In some literature, the measurement uncertainty is also called the <strong>measurement error</strong>.</p>
<p>We will denote the measurement uncertainty by $r$ .</p>
<p>The difference between the estimate (the red line) and the true value (green line) is the <strong>estimate error</strong>. As you can see the estimate error becomes smaller and smaller as we make more measurements, and it converges towards zero, while the estimated value converges towards the true value. We don’t know what the estimate error is, but we can estimate the <strong>uncertainty in estimate</strong>.</p>
<p>Intuitive derivation of the <strong>Equation3: Kalman Gain Equation</strong>:</p>
<script type="math/tex; mode=display">
K_{n}= \frac{Uncertainty \quad in \quad Estimate}{Uncertainty \quad in \quad Estimate \quad + \quad Uncertainty \quad in \quad Measurement}= \frac{p_{n,n-1}}{p_{n,n-1}+r_{n}}</script><p>where $p_{n,n-1}$ is the extrapolated estimate uncertainty, and $r_n$ is the measurement uncertainty.</p>
<p>Derivation is to minimize $p_{n,n} = k_{1}^{2}r_{n} + (1 - k_{1})^{2}p_{n,n-1}$. Visit <a href="https://www.kalmanfilter.net/KalmanGainDeriv.html" target="_blank" rel="noopener">here</a>.</p>
<p>Let’s rewrite the state update equation:</p>
<script type="math/tex; mode=display">
\hat{x}_{n,n}=~ \hat{x}_{n,n-1}+ K_{n} \left( z_{n}- \hat{x}_{n,n-1} \right) = \left( 1-K_{n} \right) \hat{x}_{n,n-1}+ K_{n}z_{n}</script><p>As you can see the Kalman Gain ($K_n$) is the weight that we give to the measurement. And $(1âˆ’K_n)$ is the weight that we give to the estimate.</p>
<p>The Kalman gain tells you how much I want to change my estimate by given a measurement.</p>
<h3 id="THE-ESTIMATE-UNCERTAINTY-UPDATE-IN-1D"><a href="#THE-ESTIMATE-UNCERTAINTY-UPDATE-IN-1D" class="headerlink" title="THE ESTIMATE UNCERTAINTY UPDATE IN 1D"></a>THE ESTIMATE UNCERTAINTY UPDATE IN 1D</h3><p>The following equation defines the estimate uncertainty update:</p>
<script type="math/tex; mode=display">
p_{n,n}=~  \left( 1-K_{n} \right) p_{n,n-1}</script><p>where $p_{n,n-1}$ is the estimate uncertainty that was calculated during the previous filter estimation, and $p_{n,n}$ is the estimate uncertainty of the current sate.</p>
<p>This equation updates the estimate uncertainty of the current state. It is called the <strong>Equation4: Covariance Update Equation</strong>. Why covariance? We will see it the following chapters.</p>
<p>It is quite clear from the equation that the estimate uncertainty is always getting smaller with each filter iteration, since $(1-K_n)\le 1$ . When the measurement uncertainty is large, then the Kalman gain will be low, therefore, the convergence of the estimate uncertainty would be slow. However, when the measurement uncertainty is small, then the Kalman gain will be high and the estimate uncertainty would quickly converge towards zero.</p>
<h3 id="THE-ESTIMATE-UNCERTAINTY-EXTRAPOLATION-IN-1D"><a href="#THE-ESTIMATE-UNCERTAINTY-EXTRAPOLATION-IN-1D" class="headerlink" title="THE ESTIMATE UNCERTAINTY EXTRAPOLATION IN 1D"></a>THE ESTIMATE UNCERTAINTY EXTRAPOLATION IN 1D</h3><p>Example:</p>
<p>state predict equation</p>
<script type="math/tex; mode=display">
\hat{x}_{n+1,n}= \hat{x}_{n,n}+  \Delta t\hat{\dot{x}}_{n,n}  \\
\hat{\dot{x}}_{n+1,n}= \hat{\dot{x}}_{n,n}</script><p>The estimate uncertainty extrapolation equation is called <strong>Equation5: Covariance Extrapolation Equation</strong> :</p>
<script type="math/tex; mode=display">
p_{n+1,n}^{x}= p_{n,n}^{x} +  \Delta t^{2} \cdot p_{n,n}^{v} \\
p_{n+1,n}^{v}= p_{n,n}^{v}</script><h3 id="PUTTING-ALL-TOGETHER"><a href="#PUTTING-ALL-TOGETHER" class="headerlink" title="PUTTING ALL TOGETHER"></a>PUTTING ALL TOGETHER</h3><p><img src="../assets/KalmanFilterAlgorithm.png" style="zoom:60%;"></p>
<p>The filter inputs are:</p>
<ul>
<li><p>Initialization</p>
</li>
<li><p>The initialization performed only once, and it provides two parameters:</p>
</li>
<li><ul>
<li>Initial System State ( $\hat x_{1,0}$ )</li>
<li>Initial State Uncertainty ( $p_{1,0}$ )</li>
</ul>
</li>
<li><p>The initialization parameters can be provided by another system, another process (for instance, search process in radar) or educated guess based on experience or theoretical knowledge. Even if the initialization parameters are not precise, the Kalman filter will be able to converge close to the real value.</p>
</li>
<li><p>Measurement</p>
</li>
<li><p>The measurement is performed for every filter cycle, and it provides two parameters:</p>
</li>
<li><ul>
<li>Measured System State ( $z_n$ )</li>
<li>Measurement Uncertainty ( $r_n$ )</li>
</ul>
</li>
</ul>
<p>In addition to the measured value, the Kalman filter requires the measurement uncertainty parameters. Usually, this parameter is provided by equipment vendor, or it can be derived by measurement equipment calibration. The radar measurement uncertainty depends on several parameters such as SNR (Signal to Nose Ratio), beam width, bandwidth, time on target, clock stability and more. Every radar measurement has different SNR, beam width and time on target. Therefore, that radar calculates the measurement uncertainty for each measurement and reports it to the tracker.</p>
<p>The filter outputs are:</p>
<ul>
<li>System State Estimate ( $\hat x_{n,n}$ )</li>
<li>Estimate Uncertainty ( $p_{n,n}$ )</li>
</ul>
<p>In addition to the System State Estimate the Kalman filter also provides the Estimate Uncertainty! We have a merit of the estimate precision. As I’ve already mentioned, the estimate uncertainty is given by:</p>
<script type="math/tex; mode=display">
p_{n,n}=~  \left( 1-K_{n} \right) p_{n,n-1}</script><p>and $p_{n,n}$ is always getting smaller with each filter iteration, since $\left( 1-K_{n} \right)   \leq 1$.</p>
<p>So it is up to us to decide how many measurements to take. If we are measuring the building height, and we are interested in precision of 3 centimeters ( $\sigma$ ), we will make the measurements until the Estimation Uncertainty ( $\sigma^2$ ) is less than 9 centimeters.</p>
<p><img src="../assets/DetailedKalmanFilterAlgorithm.png" style="zoom:85%;"></p>
<ul>
<li><strong>Process error</strong> is added to covariance extrapolation equation. [This can be understood because it cannot be added to state extrapolation equation because we should not manually add an error in the prediction. However, we know that there will be an added variance to our prediction.] </li>
</ul>
<h3 id="EXAMPLE-7-–-ESTIMATING-THE-TEMPERATURE-OF-THE-HEATING-LIQUID-Ⅰ"><a href="#EXAMPLE-7-–-ESTIMATING-THE-TEMPERATURE-OF-THE-HEATING-LIQUID-Ⅰ" class="headerlink" title="EXAMPLE 7 – ESTIMATING THE TEMPERATURE OF THE HEATING LIQUID Ⅰ"></a>EXAMPLE 7 – ESTIMATING THE TEMPERATURE OF THE HEATING LIQUID Ⅰ</h3><p><img src="../assets/ex7_EstimateVsTrueVsMeasured.png" style="zoom:65%;"></p>
<p>There are two reasons that causing lag error in our Kalman Filter example:</p>
<ul>
<li>The dynamic model doesn’t fit the case. [The true value has a linear trend while the dynamic model is a constant, which shows that Kalman Filters can perform well only when the dynamic model is reasonable.] If we know that the liquid temperature can change linearly, we can define a new model that takes into account a possible linear change in the liquid temperature. We did it in Example 4. This is a preferred method. However, if the temperature change can’t be modeled, this method won’t improve the Kalman Filter performance.</li>
<li>The process model reliability. We have chosen very low process noise $(q=0.0001)$ while the real temperature fluctuations are much bigger. On the other hand, since our model is not well defined, we can adjust the process model reliability by increasing the process noise $(q)$.</li>
</ul>
<p>We can get rid of the lag error by setting the high process uncertainty. However, since our model is not well defined, we get noisy estimates that are almost equal to the measurements, and we miss the goal of the Kalman Filter.</p>
<p>The best Kalman Filter implementation shall involve the model that is very close to reality leaving a small space for the process noise. However, the precise model is not always available, for example the airplane pilot can decide to perform a sudden maneuver that will change predicted airplane trajectory. In this case, the process noise shall be increased.</p>
<h2 id="Multidimensional-Kalman-Filter"><a href="#Multidimensional-Kalman-Filter" class="headerlink" title="Multidimensional Kalman Filter"></a>Multidimensional Kalman Filter</h2><h3 id="Variance-Rule"><a href="#Variance-Rule" class="headerlink" title="Variance Rule"></a>Variance Rule</h3><ul>
<li>$V(X) = E(X^{2}) - \mu_{X}^{2}$</li>
<li><p>$COV(X,Y) = E(XY) - \mu_{X}\mu_{Y}$; if $X$ and $Y$ are independent, then $COV(X,Y) = 0$</p>
</li>
<li><p>$V(X \pm Y) = V(X) + V(Y) \pm 2COV(X,Y)$ </p>
</li>
<li><p>$V(XY) \neq V(X)V(Y)$</p>
</li>
<li>$COV(\boldsymbol{x})                                              = E                                             \left(                                                 \left(                                                      \boldsymbol{x - \mu_{x}}                                                 \right)                                                 \left(                                                      \boldsymbol{x - \mu_{x}}                                                 \right)^{T}                                             \right)$</li>
</ul>
<p><a href="https://www.kalmanfilter.net/background2.html" target="_blank" rel="noopener">proof</a></p>
<h3 id="State-Extrapolation-Equation"><a href="#State-Extrapolation-Equation" class="headerlink" title="State Extrapolation Equation"></a>State Extrapolation Equation</h3><script type="math/tex; mode=display">
\boldsymbol{\hat{x}_{n+1,n}=F\hat{x}_{n,n}+G\hat{u}_{n,n}+w_{n}}</script><p>where,</p>
<ul>
<li>$\boldsymbol{\hat{x}_{n+1,n}}$ is a predicted system state vector at time step $n + 1$</li>
<li>$\boldsymbol{\hat{x}_{n,n}}$ is an estimated system state vector at time step $n$</li>
<li><p>$\boldsymbol{\hat{u}_{n,n}}$ is a <strong>control variable</strong> or <strong>input variable</strong> - a measurable (deterministic) input to the system [so it will not count to covariance]</p>
</li>
<li><p>$\boldsymbol{w_{n}}$ is a <strong>process noise</strong> or disturbance - an unmeasurable input that affects the state</p>
</li>
<li><p>$\boldsymbol{F}$ is a <strong>state transition matrix</strong></p>
</li>
<li><p>$\boldsymbol{G}$ is a <strong>control matrix</strong> or <strong>input transition matrix</strong> (mapping control to state variables)</p>
</li>
</ul>
<p>Note: The process noise $w_n$ do not typically appear directly in the State Extrapolation Equation. Instead, this term is used to model the uncertainty in Covariance Extrapolation Equation.</p>
<h3 id="Modeling-linear-dynamic-systems"><a href="#Modeling-linear-dynamic-systems" class="headerlink" title="Modeling linear dynamic systems"></a>Modeling linear dynamic systems</h3><p>TBA</p>
<h3 id="Covariance-Extrapolation-Equation"><a href="#Covariance-Extrapolation-Equation" class="headerlink" title="Covariance Extrapolation Equation"></a>Covariance Extrapolation Equation</h3><script type="math/tex; mode=display">
\boldsymbol{P_{n+1,n} = FP_{n,n}F^{T} + Q}</script><p>where,</p>
<ul>
<li>$\boldsymbol{P_{n,n}}$ is an estimate uncertainty (covariance) matrix of the current sate</li>
<li>$ \boldsymbol{P_{n+1,n}}$ is a predicted estimate uncertainty (covariance) matrix for the next state</li>
<li>$\boldsymbol{F}$ is a state transition matrix that we’ve derived in “Modeling linear dynamic systems” section</li>
<li>$\boldsymbol{Q}$ is a process noise matrix</li>
</ul>
<h3 id="Constructing-The-Process-Noise-Matrix-Q"><a href="#Constructing-The-Process-Noise-Matrix-Q" class="headerlink" title="Constructing The Process Noise Matrix $Q$"></a>Constructing The Process Noise Matrix $Q$</h3><p>We’ve seen that the process noise variance has a critical influence on the Kalman Filter performance. Too small $q$ causes a lag error (<a href="https://www.kalmanfilter.net/kalman1d.html#ex7" target="_blank" rel="noopener">see Example 7</a>). If the $q$ value is too large, the Kalman Filter will follow the measurements (<a href="https://www.kalmanfilter.net/kalman1d.html#ex8" target="_blank" rel="noopener">see Example 8</a>) and produce noisy estimations.</p>
<p>[Function of Q: add an additional noise to state covariance, preventing state covariance from being too small and Kalman Gain from getting close to 0.]</p>
<p>The process noise can be independent between different state variables. In this case, the process noise is a covariance matrix $\boldsymbol{Q}$ is a diagonal matrix:</p>
<script type="math/tex; mode=display">
\boldsymbol{Q} = 
                                \left[ 
                                \begin{matrix}
                                    q_{11}        &    0         &    \cdots    &    0        \\
                                    0            &    q_{22}    &    \cdots    &    0        \\ 
                                    \vdots      &   \vdots  &   \ddots  &   \vdots    \\
                                    0            &    0        &    \cdots    &    q_{kk}    \\ 
                                \end{matrix}
                                \right]</script><p>The process noise can also be dependent. In this case the process noise is corelated between the state variables.</p>
<h4 id="Discrete-noise-model"><a href="#Discrete-noise-model" class="headerlink" title="Discrete noise model"></a>Discrete noise model</h4><p>TBA</p>
<h4 id="Continuous-noise-model"><a href="#Continuous-noise-model" class="headerlink" title="Continuous noise model"></a>Continuous noise model</h4><p>TBA</p>
<h3 id="Measurement-Equation"><a href="#Measurement-Equation" class="headerlink" title="Measurement Equation"></a>Measurement Equation</h3><script type="math/tex; mode=display">
\boldsymbol{z_{n} = Hx_{n} + v_{n}}</script><p>where,</p>
<ul>
<li>$\boldsymbol{z_{n}}$ is a measurement vector</li>
<li>$\boldsymbol{x_{n}}$ is a true system state (hidden state)</li>
<li>$\boldsymbol{v_{n}}$ a random noise vector</li>
<li>$\boldsymbol{H}$ is an <strong>observation matrix</strong></li>
</ul>
<p>Usage:</p>
<ul>
<li>Scaling: $\boldsymbol{H}$ is a constant</li>
<li>State selection: only a part of the states can be measured</li>
<li>Combination of states: multiple states with less outputs</li>
</ul>
<h3 id="Interim-Summary-Uncertainty"><a href="#Interim-Summary-Uncertainty" class="headerlink" title="Interim Summary - Uncertainty"></a>Interim Summary - Uncertainty</h3><blockquote>
<p>The terms $w$ and $v$ which correspond to the process and measurement noise vectors are interesting in that they do not typically appear directly in the equations of interest, since they are unknown.</p>
<p>Instead, these terms are used to model the uncertainty (or noise) in the equations themselves.</p>
</blockquote>
<p>P.S. I should say these equations are more useful in derivation of Kalman Gain instead of practical use. I think one of the reasons is that we never know the true $w$, $v$, and $e$.</p>
<p>The process noise uncertainty is given by:</p>
<script type="math/tex; mode=display">
\boldsymbol{Q_{n}} = E\left( \boldsymbol{w_{n}w_{n}^{T}} \right)</script><p>where,</p>
<ul>
<li>$\boldsymbol{Q_{n}}$ is a covariance matrix of the process noise</li>
<li>$\boldsymbol{w_{n}}$ is a process noise</li>
</ul>
<p>The measurement uncertainty is given by:</p>
<script type="math/tex; mode=display">
\boldsymbol{R_{n}} = E\left( \boldsymbol{v_{n}v_{n}^{T}} \right)</script><p>where,</p>
<ul>
<li><p>$\boldsymbol{R_{n}}$ is a covariance matrix of the measurement</p>
</li>
<li><p>$\boldsymbol{v_{n}}$ is a measurement error</p>
</li>
</ul>
<p>The estimation uncertainty is given by:</p>
<script type="math/tex; mode=display">
\boldsymbol{P_{n,n}} = E\left( \boldsymbol{e_{n}e_{n}^{T}} \right)  = E\left( \left( \boldsymbol{x_{n} - \hat{x}_{n,n}} \right) \left( \boldsymbol{x_{n} - \hat{x}_{n,n}} \right)^{T} \right)</script><p>where,</p>
<ul>
<li>$\boldsymbol{P_{n,n}}$ is a covariance matrix of the estimation error</li>
<li>$\boldsymbol{e_{n}}$  is an estimation error</li>
<li>$\boldsymbol{x_{n}}$ is a true system state (hidden state)</li>
<li>$\boldsymbol{\hat{x}_{n,n}}$ is an estimated system state vector at time step $n$</li>
</ul>
<h3 id="State-Update-Equation"><a href="#State-Update-Equation" class="headerlink" title="State Update Equation"></a>State Update Equation</h3><p>The State Update Equation in the matrix form is given by:</p>
<script type="math/tex; mode=display">
\boldsymbol{\hat{x}_{n,n} = \hat{x}_{n,n-1} + K_{n} ( z_{n} - H \hat{x}_{n,n-1} )}</script><p>where,</p>
<ul>
<li>$\boldsymbol{\hat{x}_{n,n}}$ is a estimated system state vector at time step $n$</li>
<li><p>$\boldsymbol{\hat{x}_{n,n-1}}$ is a predicted system state vector at time step $n−1$</p>
</li>
<li><p>$\boldsymbol{K_{n}}$ is a Kalman Gain</p>
</li>
<li>$\boldsymbol{z_{n}}$ is a measurement</li>
<li>$\boldsymbol{H}$ is an observation matrix</li>
</ul>
<h3 id="Covariance-update-equation"><a href="#Covariance-update-equation" class="headerlink" title="Covariance update equation"></a>Covariance update equation</h3><p>The Covariance Update Equation is given by:</p>
<script type="math/tex; mode=display">
\boldsymbol{  P_{n,n} = \left( I - K_{n}H \right) P_{n,n-1} \left( I - K_{n}H \right)^{T} + K_{n}R_{n}K_{n}^{T} }</script><p>where,</p>
<ul>
<li>$\boldsymbol{P_{n,n} }$ is an estimate uncertainty (covariance) matrix of the current sate</li>
<li>$\boldsymbol{P_{n,n-1}}$ is a prior estimate uncertainty (covariance) matrix of the current sate (predicted at the previous state)</li>
<li><p>$\boldsymbol{K_{n}}$ is a Kalman Gain</p>
</li>
<li><p>$\boldsymbol{H}$ is an observation matrix</p>
</li>
<li>$\boldsymbol{R_{n}}$ is a Measurement Uncertainty (measurement noise covariance matrix)</li>
</ul>
<p>In many textbooks, you will find a simplified form of the Covariance Update Equation:</p>
<script type="math/tex; mode=display">
\boldsymbol{  P_{n,n} =  \left( I - K_{n}H \right) P_{n,n-1} }</script><h3 id="The-Kalman-Gain"><a href="#The-Kalman-Gain" class="headerlink" title="The Kalman Gain"></a>The Kalman Gain</h3><p>The Kalman Gain in matrix notation is given by:</p>
<script type="math/tex; mode=display">
\boldsymbol{  K_{n} = P_{n,n-1}H^{T}\left( HP_{n,n-1}H^{T} + R_{n} \right)^{-1} }</script><p>where,</p>
<ul>
<li>$\boldsymbol{K_{n} }$ is the Kalman Gain</li>
<li>$\boldsymbol{P_{n,n-1}}$ is a prior estimate uncertainty (covariance) matrix of the current sate (predicted at the previous state)</li>
<li>$\boldsymbol{H}$ is an observation matrix</li>
<li>$\boldsymbol{R_{n}}$  is a Measurement Uncertainty (measurement noise covariance matrix)</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Kalman-Filter/" rel="tag"># Kalman Filter</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/12/My-Research/" rel="next" title="< My Research Highlight >">
                <i class="fa fa-chevron-left"></i> < My Research Highlight >
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/11/Kalman_Understanding/" rel="prev" title="Deeper Understanding of Kalman Filter">
                Deeper Understanding of Kalman Filter <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Shengjie.Xiu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Michael-Xiu" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/xiao-li-dou-dan/activities" target="_blank" title="Zhihu">
                      
                        <i class="fa fa-fw fa-paper-plane"></i>Zhihu</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:xiushj@mail2.sysu.edu.cn" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/shengjie.xiu.3" target="_blank" title="FB Page">
                      
                        <i class="fa fa-fw fa-facebook"></i>FB Page</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/michael.xiu" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="skype:Shengjie Xiu?call|chat" target="_blank" title="Skype">
                      
                        <i class="fa fa-fw fa-skype"></i>Skype</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MARSS-package"><span class="nav-text">MARSS package</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Durbin’s-book"><span class="nav-text">Durbin’s book</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#linear-Gaussian-state-space-model"><span class="nav-text">linear Gaussian state space model</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Wikipedia"><span class="nav-text">Wikipedia</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tutorial-by-Alex-Becker"><span class="nav-text">Tutorial by Alex Becker</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#The-alpha-beta-gamma-Filter"><span class="nav-text">The $\alpha-\beta-\gamma$ Filter</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EXAMPLE-1-WEIGHTING-THE-GOLD"><span class="nav-text">EXAMPLE 1 WEIGHTING THE GOLD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXAMPLE-2-TRACKING-THE-CONSTANT-VELOCITY-AIRCRAFT-IN-ONE-DIMENSION"><span class="nav-text">EXAMPLE 2 TRACKING THE CONSTANT VELOCITY AIRCRAFT IN ONE DIMENSION</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Kalman-Filter-in-one-dimension"><span class="nav-text">Kalman Filter in one dimension</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#THE-ESTIMATE-UNCERTAINTY-UPDATE-IN-1D"><span class="nav-text">THE ESTIMATE UNCERTAINTY UPDATE IN 1D</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#THE-ESTIMATE-UNCERTAINTY-EXTRAPOLATION-IN-1D"><span class="nav-text">THE ESTIMATE UNCERTAINTY EXTRAPOLATION IN 1D</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PUTTING-ALL-TOGETHER"><span class="nav-text">PUTTING ALL TOGETHER</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXAMPLE-7-–-ESTIMATING-THE-TEMPERATURE-OF-THE-HEATING-LIQUID-Ⅰ"><span class="nav-text">EXAMPLE 7 – ESTIMATING THE TEMPERATURE OF THE HEATING LIQUID Ⅰ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Multidimensional-Kalman-Filter"><span class="nav-text">Multidimensional Kalman Filter</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Variance-Rule"><span class="nav-text">Variance Rule</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#State-Extrapolation-Equation"><span class="nav-text">State Extrapolation Equation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Modeling-linear-dynamic-systems"><span class="nav-text">Modeling linear dynamic systems</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Covariance-Extrapolation-Equation"><span class="nav-text">Covariance Extrapolation Equation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constructing-The-Process-Noise-Matrix-Q"><span class="nav-text">Constructing The Process Noise Matrix $Q$</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Discrete-noise-model"><span class="nav-text">Discrete noise model</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Continuous-noise-model"><span class="nav-text">Continuous noise model</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Measurement-Equation"><span class="nav-text">Measurement Equation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Interim-Summary-Uncertainty"><span class="nav-text">Interim Summary - Uncertainty</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#State-Update-Equation"><span class="nav-text">State Update Equation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Covariance-update-equation"><span class="nav-text">Covariance update equation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Kalman-Gain"><span class="nav-text">The Kalman Gain</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shengjie Xiu</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
